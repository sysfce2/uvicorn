
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The lightning-fast ASGI server.">
      
      
      
      
        <link rel="prev" href="../settings/">
      
      
        <link rel="next" href="../server-behavior/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Deployment - Uvicorn</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deployment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Uvicorn" class="md-header__button md-logo" aria-label="Uvicorn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Uvicorn
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deployment
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/encode/uvicorn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    encode/uvicorn
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!-- Determine class according to configuration -->
 
 
 

 <!-- Main navigation -->
 <nav
   class="md-nav md-nav--primary"
   aria-label=""
   data-md-level="0"
 >

   <!-- Site title -->
   <label class="md-nav__title" for="__drawer">
     <a
       href=".."
       title="Uvicorn"
       class="md-nav__button md-logo"
       aria-label="Uvicorn"
       data-md-component="logo"
     >
       
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

     </a>
     Uvicorn
   </label>

   <!-- Repository information -->
   
     <div class="md-nav__source">
       <a href="https://github.com/encode/uvicorn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    encode/uvicorn
  </div>
</a>
     </div>
   

   <!-- Render item list -->
   <ul class="md-nav__list" data-md-scrollfix>
     
       
       
       

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

     
       
       
       

  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

     
       
       
       

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Deployment
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-from-the-command-line" class="md-nav__link">
    Running from the command line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-programmatically" class="md-nav__link">
    Running programmatically
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-process-manager" class="md-nav__link">
    Using a process manager
  </a>
  
    <nav class="md-nav" aria-label="Using a process manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gunicorn" class="md-nav__link">
    Gunicorn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supervisor" class="md-nav__link">
    Supervisor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circus" class="md-nav__link">
    Circus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-behind-nginx" class="md-nav__link">
    Running behind Nginx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-behind-a-cdn" class="md-nav__link">
    Running behind a CDN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-with-https" class="md-nav__link">
    Running with HTTPS
  </a>
  
    <nav class="md-nav" aria-label="Running with HTTPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-gunicorn-worker" class="md-nav__link">
    Running gunicorn worker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

     
       
       
       

  
  
  
    <li class="md-nav__item">
      <a href="../server-behavior/" class="md-nav__link">
        Server Behavior
      </a>
    </li>
  

     
       
       
       

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

     
   </ul>

   <ul class="md-nav__list" data-md-scrollfix style="padding-top: 15px; padding-left: 10px">
     <div>
       <a href="https://fastapi.tiangolo.com"><img src="/sponsors/fastapi.png" width=150px style=></img></a>
     </div>
   </ul>
 </nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-from-the-command-line" class="md-nav__link">
    Running from the command line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-programmatically" class="md-nav__link">
    Running programmatically
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-process-manager" class="md-nav__link">
    Using a process manager
  </a>
  
    <nav class="md-nav" aria-label="Using a process manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gunicorn" class="md-nav__link">
    Gunicorn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supervisor" class="md-nav__link">
    Supervisor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circus" class="md-nav__link">
    Circus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-behind-nginx" class="md-nav__link">
    Running behind Nginx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-behind-a-cdn" class="md-nav__link">
    Running behind a CDN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-with-https" class="md-nav__link">
    Running with HTTPS
  </a>
  
    <nav class="md-nav" aria-label="Running with HTTPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-gunicorn-worker" class="md-nav__link">
    Running gunicorn worker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h1>
<p>Server deployment is a complex area, that will depend on what kind of service you're deploying Uvicorn onto.</p>
<p>As a general rule, you probably want to:</p>
<ul>
<li>Run <code>uvicorn --reload</code> from the command line for local development.</li>
<li>Run <code>gunicorn -k uvicorn.workers.UvicornWorker</code> for production.</li>
<li>Additionally run behind Nginx for self-hosted deployments.</li>
<li>Finally, run everything behind a CDN for caching support, and serious DDOS protection.</li>
</ul>
<h2 id="running-from-the-command-line">Running from the command line<a class="headerlink" href="#running-from-the-command-line" title="Permanent link">&para;</a></h2>
<p>Typically you'll run <code>uvicorn</code> from the command line.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvicorn<span class="w"> </span>main:app<span class="w"> </span>--reload<span class="w"> </span>--port<span class="w"> </span><span class="m">5000</span>
</code></pre></div>
<p>The ASGI application should be specified in the form <code>path.to.module:instance.path</code>.</p>
<p>When running locally, use <code>--reload</code> to turn on auto-reloading.</p>
<p>The <code>--reload</code> and <code>--workers</code> arguments are <strong>mutually exclusive</strong>.</p>
<p>To see the complete set of available options, use <code>uvicorn --help</code>:</p>
<!-- :cli_usage: -->
<div class="highlight"><pre><span></span><code>$ uvicorn --help
Usage: uvicorn [OPTIONS] APP

Options:
  --host TEXT                     Bind socket to this host.  [default:
                                  127.0.0.1]
  --port INTEGER                  Bind socket to this port. If 0, an available
                                  port will be picked.  [default: 8000]
  --uds TEXT                      Bind to a UNIX domain socket.
  --fd INTEGER                    Bind to socket from this file descriptor.
  --reload                        Enable auto-reload.
  --reload-dir PATH               Set reload directories explicitly, instead
                                  of using the current working directory.
  --reload-include TEXT           Set glob patterns to include while watching
                                  for files. Includes &#39;*.py&#39; by default; these
                                  defaults can be overridden with `--reload-
                                  exclude`. This option has no effect unless
                                  watchfiles is installed.
  --reload-exclude TEXT           Set glob patterns to exclude while watching
                                  for files. Includes &#39;.*, .py[cod], .sw.*,
                                  ~*&#39; by default; these defaults can be
                                  overridden with `--reload-include`. This
                                  option has no effect unless watchfiles is
                                  installed.
  --reload-delay FLOAT            Delay between previous and next check if
                                  application needs to be. Defaults to 0.25s.
                                  [default: 0.25]
  --workers INTEGER               Number of worker processes. Defaults to the
                                  $WEB_CONCURRENCY environment variable if
                                  available, or 1. Not valid with --reload.
  --loop [auto|asyncio|uvloop]    Event loop implementation.  [default: auto]
  --http [auto|h11|httptools]     HTTP protocol implementation.  [default:
                                  auto]
  --ws [auto|none|websockets|wsproto]
                                  WebSocket protocol implementation.
                                  [default: auto]
  --ws-max-size INTEGER           WebSocket max size message in bytes
                                  [default: 16777216]
  --ws-max-queue INTEGER          The maximum length of the WebSocket message
                                  queue.  [default: 32]
  --ws-ping-interval FLOAT        WebSocket ping interval  [default: 20.0]
  --ws-ping-timeout FLOAT         WebSocket ping timeout  [default: 20.0]
  --ws-per-message-deflate BOOLEAN
                                  WebSocket per-message-deflate compression
                                  [default: True]
  --lifespan [auto|on|off]        Lifespan implementation.  [default: auto]
  --interface [auto|asgi3|asgi2|wsgi]
                                  Select ASGI3, ASGI2, or WSGI as the
                                  application interface.  [default: auto]
  --env-file PATH                 Environment configuration file.
  --log-config PATH               Logging configuration file. Supported
                                  formats: .ini, .json, .yaml.
  --log-level [critical|error|warning|info|debug|trace]
                                  Log level. [default: info]
  --access-log / --no-access-log  Enable/Disable access log.
  --use-colors / --no-use-colors  Enable/Disable colorized logging.
  --proxy-headers / --no-proxy-headers
                                  Enable/Disable X-Forwarded-Proto,
                                  X-Forwarded-For, X-Forwarded-Port to
                                  populate remote address info.
  --server-header / --no-server-header
                                  Enable/Disable default Server header.
  --date-header / --no-date-header
                                  Enable/Disable default Date header.
  --forwarded-allow-ips TEXT      Comma separated list of IPs to trust with
                                  proxy headers. Defaults to the
                                  $FORWARDED_ALLOW_IPS environment variable if
                                  available, or &#39;127.0.0.1&#39;.
  --root-path TEXT                Set the ASGI &#39;root_path&#39; for applications
                                  submounted below a given URL path.
  --limit-concurrency INTEGER     Maximum number of concurrent connections or
                                  tasks to allow, before issuing HTTP 503
                                  responses.
  --backlog INTEGER               Maximum number of connections to hold in
                                  backlog
  --limit-max-requests INTEGER    Maximum number of requests to service before
                                  terminating the process.
  --timeout-keep-alive INTEGER    Close Keep-Alive connections if no new data
                                  is received within this timeout.  [default:
                                  5]
  --timeout-graceful-shutdown INTEGER
                                  Maximum number of seconds to wait for
                                  graceful shutdown.
  --ssl-keyfile TEXT              SSL key file
  --ssl-certfile TEXT             SSL certificate file
  --ssl-keyfile-password TEXT     SSL keyfile password
  --ssl-version INTEGER           SSL version to use (see stdlib ssl module&#39;s)
                                  [default: 17]
  --ssl-cert-reqs INTEGER         Whether client certificate is required (see
                                  stdlib ssl module&#39;s)  [default: 0]
  --ssl-ca-certs TEXT             CA certificates file
  --ssl-ciphers TEXT              Ciphers to use (see stdlib ssl module&#39;s)
                                  [default: TLSv1]
  --header TEXT                   Specify custom default HTTP response headers
                                  as a Name:Value pair
  --version                       Display the uvicorn version and exit.
  --app-dir TEXT                  Look for APP in the specified directory, by
                                  adding this to the PYTHONPATH. Defaults to
                                  the current working directory.
  --h11-max-incomplete-event-size INTEGER
                                  For h11, the maximum number of bytes to
                                  buffer of an incomplete event.
  --factory                       Treat APP as an application factory, i.e. a
                                  () -&gt; &lt;ASGI app&gt; callable.
  --help                          Show this message and exit.
</code></pre></div>
<p>See the <a href="../settings/">settings documentation</a> for more details on the supported options for running uvicorn.</p>
<h2 id="running-programmatically">Running programmatically<a class="headerlink" href="#running-programmatically" title="Permanent link">&para;</a></h2>
<p>To run directly from within a Python program, you should use <code>uvicorn.run(app, **config)</code>. For example:</p>
<div class="highlight"><span class="filename">main.py</span><pre><span></span><code><span class="kn">import</span> <span class="nn">uvicorn</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">App</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;main:app&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The set of configuration options is the same as for the command line tool.</p>
<p>Note that the application instance itself <em>can</em> be passed instead of the app
import string.</p>
<div class="highlight"><pre><span></span><code><span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
</code></pre></div>
<p>However, this style only works if you are not using multiprocessing (<code>workers=NUM</code>)
or reloading (<code>reload=True</code>), so we recommend using the import string style.</p>
<p>Also note that in this case, you should put <code>uvicorn.run</code> into <code>if __name__ == '__main__'</code> clause in the main module.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>reload</code> and <code>workers</code> parameters are <strong>mutually exclusive</strong>.</p>
</div>
<h2 id="using-a-process-manager">Using a process manager<a class="headerlink" href="#using-a-process-manager" title="Permanent link">&para;</a></h2>
<p>Running Uvicorn using a process manager ensures that you can run multiple processes in a resilient manner, and allows you to perform server upgrades without dropping requests.</p>
<p>A process manager will handle the socket setup, start-up multiple server processes, monitor process aliveness, and listen for signals to provide for processes restarts, shutdowns, or dialing up and down the number of running processes.</p>
<p>Uvicorn provides a lightweight way to run multiple worker processes, for example <code>--workers 4</code>, but does not provide any process monitoring.</p>
<h3 id="gunicorn">Gunicorn<a class="headerlink" href="#gunicorn" title="Permanent link">&para;</a></h3>
<p>Gunicorn is probably the simplest way to run and manage Uvicorn in a production setting. Uvicorn includes a gunicorn worker class that means you can get set up with very little configuration.</p>
<p>The following will start Gunicorn with four worker processes:</p>
<p><code>gunicorn -w 4 -k uvicorn.workers.UvicornWorker</code></p>
<p>The <code>UvicornWorker</code> implementation uses the <code>uvloop</code> and <code>httptools</code> implementations. To run under PyPy you'll want to use pure-python implementation instead. You can do this by using the <code>UvicornH11Worker</code> class.</p>
<p><code>gunicorn -w 4 -k uvicorn.workers.UvicornH11Worker</code></p>
<p>Gunicorn provides a different set of configuration options to Uvicorn, so  some options such as <code>--limit-concurrency</code> are not yet supported when running with Gunicorn.</p>
<p>If you need to pass uvicorn's config arguments to gunicorn workers then you'll have to subclass <code>UvicornWorker</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">uvicorn.workers</span> <span class="kn">import</span> <span class="n">UvicornWorker</span>

<span class="k">class</span> <span class="nc">MyUvicornWorker</span><span class="p">(</span><span class="n">UvicornWorker</span><span class="p">):</span>
    <span class="n">CONFIG_KWARGS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;asyncio&quot;</span><span class="p">,</span> <span class="s2">&quot;http&quot;</span><span class="p">:</span> <span class="s2">&quot;h11&quot;</span><span class="p">,</span> <span class="s2">&quot;lifespan&quot;</span><span class="p">:</span> <span class="s2">&quot;off&quot;</span><span class="p">}</span>
</code></pre></div>
<h3 id="supervisor">Supervisor<a class="headerlink" href="#supervisor" title="Permanent link">&para;</a></h3>
<p>To use <code>supervisor</code> as a process manager you should either:</p>
<ul>
<li>Hand over the socket to uvicorn using its file descriptor, which supervisor always makes available as <code>0</code>, and which must be set in the <code>fcgi-program</code> section.</li>
<li>Or use a UNIX domain socket for each <code>uvicorn</code> process.</li>
</ul>
<p>A simple supervisor configuration might look something like this:</p>
<div class="highlight"><span class="filename">supervisord.conf</span><pre><span></span><code><span class="k">[supervisord]</span>

<span class="k">[fcgi-program:uvicorn]</span>
<span class="na">socket</span><span class="o">=</span><span class="s">tcp://localhost:8000</span>
<span class="na">command</span><span class="o">=</span><span class="s">venv/bin/uvicorn --fd 0 main:App</span>
<span class="na">numprocs</span><span class="o">=</span><span class="s">4</span>
<span class="na">process_name</span><span class="o">=</span><span class="s">uvicorn-%(process_num)d</span>
<span class="na">stdout_logfile</span><span class="o">=</span><span class="s">/dev/stdout</span>
<span class="na">stdout_logfile_maxbytes</span><span class="o">=</span><span class="s">0</span>
</code></pre></div>
<p>Then run with <code>supervisord -n</code>.</p>
<h3 id="circus">Circus<a class="headerlink" href="#circus" title="Permanent link">&para;</a></h3>
<p>To use <code>circus</code> as a process manager, you should either:</p>
<ul>
<li>Hand over the socket to uvicorn using its file descriptor, which circus makes available as <code>$(circus.sockets.web)</code>.</li>
<li>Or use a UNIX domain socket for each <code>uvicorn</code> process.</li>
</ul>
<p>A simple circus configuration might look something like this:</p>
<div class="highlight"><span class="filename">circus.ini</span><pre><span></span><code><span class="k">[watcher:web]</span>
<span class="na">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">venv/bin/uvicorn --fd $(circus.sockets.web) main:App</span>
<span class="na">use_sockets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">True</span>
<span class="na">numprocesses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>

<span class="k">[socket:web]</span>
<span class="na">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.0.0.0</span>
<span class="na">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8000</span>
</code></pre></div>
<p>Then run <code>circusd circus.ini</code>.</p>
<h2 id="running-behind-nginx">Running behind Nginx<a class="headerlink" href="#running-behind-nginx" title="Permanent link">&para;</a></h2>
<p>Using Nginx as a proxy in front of your Uvicorn processes may not be necessary, but is recommended for additional resilience. Nginx can deal with serving your static media and buffering slow requests, leaving your application servers free from load as much as possible.</p>
<p>In managed environments such as <code>Heroku</code>, you won't typically need to configure Nginx, as your server processes will already be running behind load balancing proxies.</p>
<p>The recommended configuration for proxying from Nginx is to use a UNIX domain socket between Nginx and whatever the process manager that is being used to run Uvicorn.
Note that when doing this you will need to run Uvicorn with <code>--forwarded-allow-ips='*'</code> to ensure that the domain socket is trusted as a source from which to proxy headers.</p>
<p>When fronting the application with a proxy server you want to make sure that the proxy sets headers to ensure that the application can properly determine the client address of the incoming connection, and if the connection was over <code>http</code> or <code>https</code>.</p>
<p>You should ensure that the <code>X-Forwarded-For</code> and <code>X-Forwarded-Proto</code> headers are set by the proxy, and that Uvicorn is run using the <code>--proxy-headers</code> setting. This ensures that the ASGI scope includes correct <code>client</code> and <code>scheme</code> information.</p>
<p>Here's how a simple Nginx configuration might look. This example includes setting proxy headers, and using a UNIX domain socket to communicate with the application server.</p>
<p>It also includes some basic configuration to forward websocket connections. For more info on this, check <a href="https://nginx.org/en/docs/http/websocket.html">Nginx recommendations</a>.</p>
<div class="highlight"><pre><span></span><code>http {
  server {
    listen 80;
    client_max_body_size 4G;

    server_name example.com;

    location / {
      proxy_set_header Host $http_host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
      proxy_redirect off;
      proxy_buffering off;
      proxy_pass http://uvicorn;
    }

    location /static {
      # path for static files
      root /path/to/app/static;
    }
  }

  map $http_upgrade $connection_upgrade {
    default upgrade;
    &#39;&#39; close;
  }

  upstream uvicorn {
    server unix:/tmp/uvicorn.sock;
  }

}
</code></pre></div>
<p>Uvicorn's <code>--proxy-headers</code> behavior may not be sufficient for more complex proxy configurations that use different combinations of headers, or where the application is running behind more than one intermediary proxying service.</p>
<p>In those cases, you might want to use an ASGI middleware to set the <code>client</code> and <code>scheme</code> dependant on the request headers.</p>
<h2 id="running-behind-a-cdn">Running behind a CDN<a class="headerlink" href="#running-behind-a-cdn" title="Permanent link">&para;</a></h2>
<p>Running behind a content delivery network, such as Cloudflare or Cloud Front, provides a serious layer of protection against DDOS attacks. Your service will be running behind huge clusters of proxies and load balancers that are designed for handling huge amounts of traffic, and have capabilities for detecting and closing off connections from DDOS attacks.</p>
<p>Proper usage of cache control headers can mean that a CDN is able to serve large amounts of data without always having to forward the request on to your server.</p>
<p>Content Delivery Networks can also be a low-effort way to provide HTTPS termination.</p>
<h2 id="running-with-https">Running with HTTPS<a class="headerlink" href="#running-with-https" title="Permanent link">&para;</a></h2>
<p>To run uvicorn with https, a certificate and a private key are required.
The recommended way to get them is using <a href="https://letsencrypt.org/">Let's Encrypt</a>.</p>
<p>For local development with https, it's possible to use <a href="https://github.com/FiloSottile/mkcert">mkcert</a>
to generate a valid certificate and private key.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvicorn<span class="w"> </span>main:app<span class="w"> </span>--port<span class="w"> </span><span class="m">5000</span><span class="w"> </span>--ssl-keyfile<span class="o">=</span>./key.pem<span class="w"> </span>--ssl-certfile<span class="o">=</span>./cert.pem
</code></pre></div>
<h3 id="running-gunicorn-worker">Running gunicorn worker<a class="headerlink" href="#running-gunicorn-worker" title="Permanent link">&para;</a></h3>
<p>It's also possible to use certificates with uvicorn's worker for gunicorn.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>gunicorn<span class="w"> </span>--keyfile<span class="o">=</span>./key.pem<span class="w"> </span>--certfile<span class="o">=</span>./cert.pem<span class="w"> </span>-k<span class="w"> </span>uvicorn.workers.UvicornWorker<span class="w"> </span>main:app
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>